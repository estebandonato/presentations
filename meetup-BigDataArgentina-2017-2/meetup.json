{"paragraphs":[{"text":"%spark\n\nimport org.graphframes._\nval v = sqlContext.createDataFrame(List(\n  (\"a\", \"Alice\", 34),\n  (\"b\", \"Bob\", 36),\n  (\"c\", \"Charlie\", 30)\n)).toDF(\"id\", \"name\", \"age\")\n\nval e = sqlContext.createDataFrame(List(\n (\"a\", \"b\", \"friend\"),\n  (\"b\", \"c\", \"follow\"),\n  (\"c\", \"b\", \"follow\")\n)).toDF(\"src\", \"dst\", \"relationship\")\n\n// Create a GraphFrame\nval gf = GraphFrame(v, e)\n","user":"anonymous","dateUpdated":"2017-04-27T13:27:56-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493094482080_-1155581883","id":"20170425-012802_1237006003","dateCreated":"2017-04-25T01:28:02-0300","dateStarted":"2017-04-27T13:27:56-0300","dateFinished":"2017-04-27T13:27:57-0300","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8757"},{"text":"%spark\n\nimport org.apache.spark._\nimport org.apache.spark.graphx._\nimport org.apache.spark.rdd.RDD\n\n// Create an RDD for the vertices\nval v = sc.parallelize(Array(\n  (1L, (\"Alice\", 34)), \n  (2L, ( \"Bob\", 36)),\n  (3L, (\"Charlie\", 30))))\n  \nval e = sc.parallelize(Array(\n  Edge(1L, 2L, \"friend\"),    \n  Edge(2L, 3L, \"follow\"),\n  Edge(3L, 2L, \"follow\")))\n  \nval gX = Graph(v, e)","user":"anonymous","dateUpdated":"2017-04-27T13:27:56-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493094505125_-2109158223","id":"20170425-012825_2074999892","dateCreated":"2017-04-25T01:28:25-0300","dateStarted":"2017-04-27T13:27:56-0300","dateFinished":"2017-04-27T13:28:00-0300","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8758"},{"text":"%spark\n\ngf.inDegrees.show\ngf.outDegrees.show\ngf.degrees.show\n\ngf.inDegrees.join(gf.outDegrees, \"id\").join(gf.degrees, \"id\").show\n\nval gf_filtered = GraphFrame(gf.vertices, gf.edges.filter(\"relationship = 'follow'\"))\ngf_filtered.degrees.show\n\ngX.inDegrees.collect.foreach(println)\ngX.outDegrees.collect.foreach(println)\ngX.degrees.collect.foreach(println)\n\ngX.inDegrees.join(gX.outDegrees).collect.foreach(println)\n\nval gX_filtered = gX.subgraph(epred = (triplet) => triplet.attr == \"follow\")\ngX_filtered.degrees.collect.foreach(println)","user":"anonymous","dateUpdated":"2017-04-27T13:27:56-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493096623424_163017707","id":"20170425-020343_178732648","dateCreated":"2017-04-25T02:03:43-0300","dateStarted":"2017-04-27T13:27:58-0300","dateFinished":"2017-04-27T13:28:08-0300","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8759"},{"text":"%spark\n\nval v1 = sqlContext.createDataFrame(List(\n  (\"a\", \"xx\"),\n  (\"b\", \"xx\"),\n  (\"c\", \"xx\"),\n  (\"d\", \"yy\"),\n  (\"e\", \"yy\")\n)).toDF(\"id\", \"att\")\n\nval e1 = sqlContext.createDataFrame(List(\n (\"a\", \"b\"),\n  (\"b\", \"c\"),\n  (\"a\", \"c\"),\n  (\"c\", \"d\"),\n  (\"d\", \"e\"),\n  (\"c\", \"e\")\n)).toDF(\"src\", \"dst\")\n\nval gf1 = GraphFrame(v1,e1)\ngf1.triangleCount.run().show\ngf1.find(\"(a)-[]->(b); (b)-[]->(c); (a)-[]->(c)\").filter(\"a.att = b.att and b.att = c.att\").show\n\n","user":"anonymous","dateUpdated":"2017-04-27T13:27:56-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493097518423_-498138555","id":"20170425-021838_1055804334","dateCreated":"2017-04-25T02:18:38-0300","dateStarted":"2017-04-27T13:28:00-0300","dateFinished":"2017-04-27T13:28:24-0300","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8760"},{"text":"%spark\n\nimport org.graphframes.lib.{AggregateMessages => AM}\n\ngf.aggregateMessages\n    .sendToDst(AM.src(\"age\"))\n    .sendToSrc(AM.dst(\"age\"))\n    .agg(avg(AM.msg).as(\"avg_age\"))\n    .show()\n    \ngX.aggregateMessages[(Int,Int)](\n    ctx => { ctx.sendToSrc((ctx.dstAttr._2,1)); ctx.sendToDst((ctx.srcAttr._2,1)) },   \n    (m1, m2) => (m1._1 + m2._1, m1._2 + m2._2)\n    )\n    .mapValues(x => x._1.toDouble / x._2)\n    .collect().foreach(println)\n","user":"anonymous","dateUpdated":"2017-04-27T13:27:56-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493101690928_-1931904546","id":"20170425-032810_812335692","dateCreated":"2017-04-25T03:28:10-0300","dateStarted":"2017-04-27T13:28:08-0300","dateFinished":"2017-04-27T13:28:26-0300","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8761"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2017-04-27T13:27:56-0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493102397433_1947341302","id":"20170425-033957_2066923985","dateCreated":"2017-04-25T03:39:57-0300","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8762"}],"name":"meetup","id":"2CGH67UKG","angularObjects":{"2CCYQ7KCC:shared_process":[],"2CBAG2G4H:shared_process":[],"2CDEYAXJP:shared_process":[],"2CBSMFZ3V:shared_process":[],"2CE54DD8Z:shared_process":[],"2CB85DDJJ:shared_process":[],"2CBTQMGT2:shared_process":[],"2CABE5JSD:shared_process":[],"2CC7F19Q6:shared_process":[],"2CCXG9QPK:shared_process":[],"2CC8W61BU:shared_process":[],"2CC5GMPF9:shared_process":[],"2CDWE96E9:shared_process":[],"2CE2X1A8G:shared_process":[],"2CDYDS2TD:shared_process":[],"2CBEYSRE7:shared_process":[],"2CB7PZB4G:shared_process":[],"2CAGTYRVD:shared_process":[],"2CCTEVY8Y:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}